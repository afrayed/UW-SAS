%let wrds = wrds.wharton.upenn.edu 4016;
options comamid = TCP remote = wrds;
signon username = _prompt_;
rsubmit;

/* *************************************************** */
/* ************** W R D S   M A C R O S ************** */
/* ***************  Merging CRSP Data  *************** */
/* *************************************************** */
/* *** Date: May, 2009                                 */ 
/* ***   By: Rabih Moussawi, Luis Palacios, WRDS       */ 
/* *** Objective: Merge CRSP Stock and Events data     */
/*******************************************************/
 
%macro crspmerge (s=,start=,end=,sfvars=,sevars=,filters=,final_ds=);
/* Check Series: Daily or Monthly and define datasets - Default is Monthly  */
%if &s=D %then %let s=d; %else %if &s ne d %then %let s=m;
%if (%sysfunc(libref(crsp))) %then %do;
        libname crsp "/wrds/crsp/sasdata/a_stock"; 
%end;
%let sf       = crsp.&s.sf ;
%let se       = crsp.&s.seall ;
%let senames  = crsp.&s.senames ;
 
%put ; %put ; %put ; %put ; %put ;
%put #### ## # Merging CRSP Stock File (&s.sf) and Event File (&s.se) # ## #### ;
 
options nonotes;
%let sdate = %sysfunc(putn("&start"d,5.)) ;
%let edate = %sysfunc(putn("&end"d,5.)) ;
 
%if %length(&sevars) > 2 %then %let sevars = %sysfunc(compbl(&sevars));
  %else %let sevars = ticker ncusip exchcd shrcd;
%let sevars  = %sysfunc(lowcase(&sevars));
%let nsevars = %eval(%sysfunc(length(&sevars))-%sysfunc(length(%sysfunc(compress(&sevars))))+1);
 
%* create lag event variable names to be used in the RETAIN statement ;
%let sevars_l = lag_%sysfunc(tranwrd(&sevars,%str( ),%str( lag_)));
 
%if %length(&filters) > 2 %then %let filters = and &filters;
  %else %let filters = %str( );
%if &final_ds = %str() %then %let final_ds = work.crsp_&s.;
 
%put #### ### ## # ;
/* Get stock data */
proc sql;
        create table sfdata
        as select *
        from &sf (keep= permco permno date &sfvars)
        where date between &sdate and &edate and permno in
        (select distinct permno from
      &senames(WHERE=(&edate>=NAMEDT and &sdate<=NAMEENDT)
         keep=permno namedt nameendt) )
        order by permno, date;
        quit;
%put #### ### ## # ;
/* Get event data */
proc sql;
   create table sedata
   as select a.*
   from &se (keep= permco permno date &sevars exchcd) as a,
    (select distinct permno, min(namedt) as minnamedt from
      &senames(WHERE=(&edate>=NAMEDT and &sdate<=NAMEENDT)
         keep=permno namedt nameendt) group by permno) as b
        where a.date >= b.minnamedt and a.date <= &edate and a.permno =b.permno
   order by a.permno, a.date;
   quit;
%put #### ### ## # ;
/* Merge stock and event data */
%let eventvars = ticker comnam ncusip shrout siccd exchcd shrcls shrcd shrflg trtscd nmsind mmcnt nsdinx;
* variables whose values need to be retain to fill the blanks;
 
data &final_ds (keep=permco permno date &sfvars &sevars exchcd);
merge sedata (in=eventdata) sfdata (in=stockdata);
by permno date; retain &sevars_l;
%do i = 1 %to &nsevars;
  %let var   = %scan(&sevars,&i,%str( ));
  %let var_l = %scan(&sevars_l,&i,%str( ));
  %if %sysfunc(index(&eventvars,&var))>0 %then
   %do;
     if eventdata or first.permno then &var_l = &var. ;
         else if not eventdata then &var = &var_l. ;
   %end;
 %end;
if eventdata and not stockdata then delete;
drop  &sevars_l ;
run;
%put #### ### ## # ;
    /* ------------------------------------------------------------------------------ */
    /* The following sort is included to handle duplicate observations when a company */
    /* has more than one distribution on a given date. For example, a stock and cash  */
    /* distribution on the same date will generate two records, identical except for  */
    /* different DISTCD and DISTAMT (and possibly other) values. The NODUPLICATES     */
    /* option only deletes a record if all values for all variables are the same as   */
    /* those in another record. So, in the above example, if DISTCD is included in    */
    /* &sevars a record will not be deleted, but a redundant record will be deleted   */
    /* if DISTCD and DISTAMT are not included in &sevars.                             */
    /* ------------------------------------------------------------------------------ */
proc sort data=&final_ds noduplicates;
    /* the "exchcd" condition below removes rows with empty stock price data created  */
    /* because CRSP event file track some event information even before the stock     */
    /* is trading in major stock exchange                                             */
where 1 &filters;
    by date permno;
run;
%put #### ### ## # ;
 
proc sql;
drop table sedata, sfdata;
quit;
 
options notes;
%put #### ## # Done: Dataset &final_ds Created! # ## ####;
%put ;
 
%mend crspmerge;
 
 
/* ***************************************************************************************** */
/* ***************************** Unless otherwise noted, *********************************** */
/* All material is Copyright 1994-2009: The Wharton School of the University of Pennsylvania */
/* ****************************** All rights reserved ************************************** */

%CRSPMERGE (s=m,start=01JAN1962,end=31DEC2011,sfvars=prc ret shrout,sevars=permno permco siccd shrcd,filters=shrcd in (10,11),final_ds=crspbase);

proc download data = crspbase out = harford.crsp;
quit;

data crsptrial;
	set crspbase;
	drop SHRCD EXCHCD DATE;
	YEAR = year(DATE);
	label YEAR = "Year of Observation";
	MKTVAL = PRC * SHROUT;
	label MKTVAL = "Market Value of Equity";
	if PRC ne . and (RET ne .);
	if SICCD ne 0;
	if RET ge -20;
	MLRET = log(1 + RET);
run;

proc sort data = crsptrial;
	by PERMNO SICCD YEAR;
run;

proc means data = crsptrial n sum noprint;
	by PERMNO SICCD YEAR;
	var MLRET;
	output out = eqwyearreturn n = NMLRET sum = TMLRET;
quit;

data crspfinal;
	set eqwyearreturn;
	drop _TYPE_ _FREQ_;
	TLRET = (exp(TMLRET)) - 1;
	if NMLRET < 12;
	label TLRET = "Yearly Adjusted Monthly Returns";
	if SICCD ge 100 and SICCD le 199 then FF17IND = 1;
	if SICCD ge 200 and SICCD le 299 then FF17IND = 1;
	if SICCD ge 700 and SICCD le 799 then FF17IND = 1;
	if SICCD ge 900 and SICCD le 999 then FF17IND = 1;
	if SICCD ge 2000 and SICCD le 2009 then FF17IND = 1;
	if SICCD ge 2010 and SICCD le 2019 then FF17IND = 1;
	if SICCD ge 2020 and SICCD le 2029 then FF17IND = 1;
	if SICCD ge 2030 and SICCD le 2039 then FF17IND = 1;
	if SICCD ge 2040 and SICCD le 2046 then FF17IND = 1;
	if SICCD ge 2047 and SICCD le 2047 then FF17IND = 1;
	if SICCD ge 2048 and SICCD le 2048 then FF17IND = 1;
	if SICCD ge 2050 and SICCD le 2059 then FF17IND = 1;
	if SICCD ge 2060 and SICCD le 2063 then FF17IND = 1;
	if SICCD ge 2064 and SICCD le 2068 then FF17IND = 1;
	if SICCD ge 2070 and SICCD le 2079 then FF17IND = 1;
	if SICCD ge 2080 and SICCD le 2080 then FF17IND = 1;
	if SICCD ge 2082 and SICCD le 2082 then FF17IND = 1;
	if SICCD ge 2083 and SICCD le 2083 then FF17IND = 1;
	if SICCD ge 2084 and SICCD le 2084 then FF17IND = 1;
	if SICCD ge 2085 and SICCD le 2085 then FF17IND = 1;
	if SICCD ge 2086 and SICCD le 2086 then FF17IND = 1;
	if SICCD ge 2087 and SICCD le 2087 then FF17IND = 1;
	if SICCD ge 2090 and SICCD le 2092 then FF17IND = 1;
	if SICCD ge 2095 and SICCD le 2095 then FF17IND = 1;
	if SICCD ge 2096 and SICCD le 2096 then FF17IND = 1;
	if SICCD ge 2097 and SICCD le 2097 then FF17IND = 1;
	if SICCD ge 2098 and SICCD le 2099 then FF17IND = 1;
	if SICCD ge 5140 and SICCD le 5149 then FF17IND = 1;
	if SICCD ge 5150 and SICCD le 5159 then FF17IND = 1;
	if SICCD ge 5180 and SICCD le 5182 then FF17IND = 1;
	if SICCD ge 5191 and SICCD le 5191 then FF17IND = 1;
	if SICCD ge 1000 and SICCD le 1009 then FF17IND = 2;
	if SICCD ge 1010 and SICCD le 1019 then FF17IND = 2;
	if SICCD ge 1020 and SICCD le 1029 then FF17IND = 2;
	if SICCD ge 1030 and SICCD le 1039 then FF17IND = 2;
	if SICCD ge 1040 and SICCD le 1049 then FF17IND = 2;
	if SICCD ge 1060 and SICCD le 1069 then FF17IND = 2;
	if SICCD ge 1080 and SICCD le 1089 then FF17IND = 2;
	if SICCD ge 1090 and SICCD le 1099 then FF17IND = 2;
	if SICCD ge 1200 and SICCD le 1299 then FF17IND = 2;
	if SICCD ge 1400 and SICCD le 1499 then FF17IND = 2;
	if SICCD ge 5050 and SICCD le 5052 then FF17IND = 2;
	if SICCD ge 1300 and SICCD le 1300 then FF17IND = 3;
	if SICCD ge 1310 and SICCD le 1319 then FF17IND = 3;
	if SICCD ge 1320 and SICCD le 1329 then FF17IND = 3;
	if SICCD ge 1380 and SICCD le 1380 then FF17IND = 3;
	if SICCD ge 1381 and SICCD le 1381 then FF17IND = 3;
	if SICCD ge 1382 and SICCD le 1382 then FF17IND = 3;
	if SICCD ge 1389 and SICCD le 1389 then FF17IND = 3;
	if SICCD ge 2900 and SICCD le 2912 then FF17IND = 3;
	if SICCD ge 5170 and SICCD le 5172 then FF17IND = 3;
	if SICCD ge 2200 and SICCD le 2269 then FF17IND = 4;
	if SICCD ge 2270 and SICCD le 2279 then FF17IND = 4;
	if SICCD ge 2280 and SICCD le 2284 then FF17IND = 4;
	if SICCD ge 2290 and SICCD le 2295 then FF17IND = 4;
	if SICCD ge 2296 and SICCD le 2296 then FF17IND = 4;
	if SICCD ge 2297 and SICCD le 2297 then FF17IND = 4;
	if SICCD ge 2298 and SICCD le 2298 then FF17IND = 4;
	if SICCD ge 2299 and SICCD le 2299 then FF17IND = 4;
	if SICCD ge 2300 and SICCD le 2390 then FF17IND = 4;
	if SICCD ge 2391 and SICCD le 2392 then FF17IND = 4;
	if SICCD ge 2393 and SICCD le 2395 then FF17IND = 4;
	if SICCD ge 2396 and SICCD le 2396 then FF17IND = 4;
	if SICCD ge 2397 and SICCD le 2399 then FF17IND = 4;
	if SICCD ge 3020 and SICCD le 3021 then FF17IND = 4;
	if SICCD ge 3100 and SICCD le 3111 then FF17IND = 4;
	if SICCD ge 3130 and SICCD le 3131 then FF17IND = 4;
	if SICCD ge 3140 and SICCD le 3149 then FF17IND = 4;
	if SICCD ge 3150 and SICCD le 3151 then FF17IND = 4;
	if SICCD ge 3963 and SICCD le 3965 then FF17IND = 4;
	if SICCD ge 5130 and SICCD le 5139 then FF17IND = 4;
	if SICCD ge 2510 and SICCD le 2519 then FF17IND = 5;
	if SICCD ge 2590 and SICCD le 2599 then FF17IND = 5;
	if SICCD ge 3060 and SICCD le 3069 then FF17IND = 5;
	if SICCD ge 3070 and SICCD le 3079 then FF17IND = 5;
	if SICCD ge 3080 and SICCD le 3089 then FF17IND = 5;
	if SICCD ge 3090 and SICCD le 3099 then FF17IND = 5;
	if SICCD ge 3630 and SICCD le 3639 then FF17IND = 5;
	if SICCD ge 3650 and SICCD le 3651 then FF17IND = 5;
	if SICCD ge 3652 and SICCD le 3652 then FF17IND = 5;
	if SICCD ge 3860 and SICCD le 3861 then FF17IND = 5;
	if SICCD ge 3870 and SICCD le 3873 then FF17IND = 5;
	if SICCD ge 3910 and SICCD le 3911 then FF17IND = 5;
	if SICCD ge 3914 and SICCD le 3914 then FF17IND = 5;
	if SICCD ge 3915 and SICCD le 3915 then FF17IND = 5;
	if SICCD ge 3930 and SICCD le 3931 then FF17IND = 5;
	if SICCD ge 3940 and SICCD le 3949 then FF17IND = 5;
	if SICCD ge 3960 and SICCD le 3962 then FF17IND = 5;
	if SICCD ge 5020 and SICCD le 5023 then FF17IND = 5;
	if SICCD ge 5064 and SICCD le 5064 then FF17IND = 5;
	if SICCD ge 5094 and SICCD le 5094 then FF17IND = 5;
	if SICCD ge 5099 and SICCD le 5099 then FF17IND = 5;
	if SICCD ge 2800 and SICCD le 2809 then FF17IND = 6;
	if SICCD ge 2810 and SICCD le 2819 then FF17IND = 6;
	if SICCD ge 2820 and SICCD le 2829 then FF17IND = 6;
	if SICCD ge 2860 and SICCD le 2869 then FF17IND = 6;
	if SICCD ge 2870 and SICCD le 2879 then FF17IND = 6;
	if SICCD ge 2890 and SICCD le 2899 then FF17IND = 6;
	if SICCD ge 5160 and SICCD le 5169 then FF17IND = 6;
	if SICCD ge 2100 and SICCD le 2199 then FF17IND = 7;
	if SICCD ge 2830 and SICCD le 2830 then FF17IND = 7;
	if SICCD ge 2831 and SICCD le 2831 then FF17IND = 7;
	if SICCD ge 2833 and SICCD le 2833 then FF17IND = 7;
	if SICCD ge 2834 and SICCD le 2834 then FF17IND = 7;
	if SICCD ge 2840 and SICCD le 2843 then FF17IND = 7;
	if SICCD ge 2844 and SICCD le 2844 then FF17IND = 7;
	if SICCD ge 5120 and SICCD le 5122 then FF17IND = 7;
	if SICCD ge 5194 and SICCD le 5194 then FF17IND = 7;
	if SICCD ge 800 and SICCD le 899 then FF17IND = 8;
	if SICCD ge 1500 and SICCD le 1511 then FF17IND = 8;
	if SICCD ge 1520 and SICCD le 1529 then FF17IND = 8;
	if SICCD ge 1530 and SICCD le 1539 then FF17IND = 8;
	if SICCD ge 1540 and SICCD le 1549 then FF17IND = 8;
	if SICCD ge 1600 and SICCD le 1699 then FF17IND = 8;
	if SICCD ge 1700 and SICCD le 1799 then FF17IND = 8;
	if SICCD ge 2400 and SICCD le 2439 then FF17IND = 8;
	if SICCD ge 2440 and SICCD le 2449 then FF17IND = 8;
	if SICCD ge 2450 and SICCD le 2459 then FF17IND = 8;
	if SICCD ge 2490 and SICCD le 2499 then FF17IND = 8;
	if SICCD ge 2850 and SICCD le 2859 then FF17IND = 8;
	if SICCD ge 2950 and SICCD le 2952 then FF17IND = 8;
	if SICCD ge 3200 and SICCD le 3200 then FF17IND = 8;
	if SICCD ge 3210 and SICCD le 3211 then FF17IND = 8;
	if SICCD ge 3240 and SICCD le 3241 then FF17IND = 8;
	if SICCD ge 3250 and SICCD le 3259 then FF17IND = 8;
	if SICCD ge 3261 and SICCD le 3261 then FF17IND = 8;
	if SICCD ge 3264 and SICCD le 3264 then FF17IND = 8;
	if SICCD ge 3270 and SICCD le 3275 then FF17IND = 8;
	if SICCD ge 3280 and SICCD le 3281 then FF17IND = 8;
	if SICCD ge 3290 and SICCD le 3293 then FF17IND = 8;
	if SICCD ge 3420 and SICCD le 3429 then FF17IND = 8;
	if SICCD ge 3430 and SICCD le 3433 then FF17IND = 8;
	if SICCD ge 3440 and SICCD le 3441 then FF17IND = 8;
	if SICCD ge 3442 and SICCD le 3442 then FF17IND = 8;
	if SICCD ge 3446 and SICCD le 3446 then FF17IND = 8;
	if SICCD ge 3448 and SICCD le 3448 then FF17IND = 8;
	if SICCD ge 3449 and SICCD le 3449 then FF17IND = 8;
	if SICCD ge 3450 and SICCD le 3451 then FF17IND = 8;
	if SICCD ge 3452 and SICCD le 3452 then FF17IND = 8;
	if SICCD ge 5030 and SICCD le 5039 then FF17IND = 8;
	if SICCD ge 5070 and SICCD le 5078 then FF17IND = 8;
	if SICCD ge 5198 and SICCD le 5198 then FF17IND = 8;
	if SICCD ge 5210 and SICCD le 5211 then FF17IND = 8;
	if SICCD ge 5230 and SICCD le 5231 then FF17IND = 8;
	if SICCD ge 5250 and SICCD le 5251 then FF17IND = 8;
	if SICCD ge 3300 and SICCD le 3300 then FF17IND = 9;
	if SICCD ge 3310 and SICCD le 3317 then FF17IND = 9;
	if SICCD ge 3320 and SICCD le 3325 then FF17IND = 9;
	if SICCD ge 3330 and SICCD le 3339 then FF17IND = 9;
	if SICCD ge 3340 and SICCD le 3341 then FF17IND = 9;
	if SICCD ge 3350 and SICCD le 3357 then FF17IND = 9;
	if SICCD ge 3360 and SICCD le 3369 then FF17IND = 9;
	if SICCD ge 3390 and SICCD le 3399 then FF17IND = 9;
	if SICCD ge 3410 and SICCD le 3412 then FF17IND = 10;
	if SICCD ge 3443 and SICCD le 3443 then FF17IND = 10;
	if SICCD ge 3444 and SICCD le 3444 then FF17IND = 10;
	if SICCD ge 3460 and SICCD le 3469 then FF17IND = 10;
	if SICCD ge 3470 and SICCD le 3479 then FF17IND = 10;
	if SICCD ge 3480 and SICCD le 3489 then FF17IND = 10;
	if SICCD ge 3490 and SICCD le 3499 then FF17IND = 10;
	if SICCD ge 3510 and SICCD le 3519 then FF17IND = 11;
	if SICCD ge 3520 and SICCD le 3529 then FF17IND = 11;
	if SICCD ge 3530 and SICCD le 3530 then FF17IND = 11;
	if SICCD ge 3531 and SICCD le 3531 then FF17IND = 11;
	if SICCD ge 3532 and SICCD le 3532 then FF17IND = 11;
	if SICCD ge 3533 and SICCD le 3533 then FF17IND = 11;
	if SICCD ge 3534 and SICCD le 3534 then FF17IND = 11;
	if SICCD ge 3535 and SICCD le 3535 then FF17IND = 11;
	if SICCD ge 3536 and SICCD le 3536 then FF17IND = 11;
	if SICCD ge 3540 and SICCD le 3549 then FF17IND = 11;
	if SICCD ge 3550 and SICCD le 3559 then FF17IND = 11;
	if SICCD ge 3560 and SICCD le 3569 then FF17IND = 11;
	if SICCD ge 3570 and SICCD le 3579 then FF17IND = 11;
	if SICCD ge 3580 and SICCD le 3580 then FF17IND = 11;
	if SICCD ge 3581 and SICCD le 3581 then FF17IND = 11;
	if SICCD ge 3582 and SICCD le 3582 then FF17IND = 11;
	if SICCD ge 3585 and SICCD le 3585 then FF17IND = 11;
	if SICCD ge 3586 and SICCD le 3586 then FF17IND = 11;
	if SICCD ge 3589 and SICCD le 3589 then FF17IND = 11;
	if SICCD ge 3590 and SICCD le 3599 then FF17IND = 11;
	if SICCD ge 3600 and SICCD le 3600 then FF17IND = 11;
	if SICCD ge 3610 and SICCD le 3613 then FF17IND = 11;
	if SICCD ge 3620 and SICCD le 3621 then FF17IND = 11;
	if SICCD ge 3622 and SICCD le 3622 then FF17IND = 11;
	if SICCD ge 3623 and SICCD le 3629 then FF17IND = 11;
	if SICCD ge 3670 and SICCD le 3679 then FF17IND = 11;
	if SICCD ge 3680 and SICCD le 3680 then FF17IND = 11;
	if SICCD ge 3681 and SICCD le 3681 then FF17IND = 11;
	if SICCD ge 3682 and SICCD le 3682 then FF17IND = 11;
	if SICCD ge 3683 and SICCD le 3683 then FF17IND = 11;
	if SICCD ge 3684 and SICCD le 3684 then FF17IND = 11;
	if SICCD ge 3685 and SICCD le 3685 then FF17IND = 11;
	if SICCD ge 3686 and SICCD le 3686 then FF17IND = 11;
	if SICCD ge 3687 and SICCD le 3687 then FF17IND = 11;
	if SICCD ge 3688 and SICCD le 3688 then FF17IND = 11;
	if SICCD ge 3689 and SICCD le 3689 then FF17IND = 11;
	if SICCD ge 3690 and SICCD le 3690 then FF17IND = 11;
	if SICCD ge 3691 and SICCD le 3692 then FF17IND = 11;
	if SICCD ge 3693 and SICCD le 3693 then FF17IND = 11;
	if SICCD ge 3694 and SICCD le 3694 then FF17IND = 11;
	if SICCD ge 3695 and SICCD le 3695 then FF17IND = 11;
	if SICCD ge 3699 and SICCD le 3699 then FF17IND = 11;
	if SICCD ge 3810 and SICCD le 3810 then FF17IND = 11;
	if SICCD ge 3811 and SICCD le 3811 then FF17IND = 11;
	if SICCD ge 3812 and SICCD le 3812 then FF17IND = 11;
	if SICCD ge 3820 and SICCD le 3820 then FF17IND = 11;
	if SICCD ge 3821 and SICCD le 3821 then FF17IND = 11;
	if SICCD ge 3822 and SICCD le 3822 then FF17IND = 11;
	if SICCD ge 3823 and SICCD le 3823 then FF17IND = 11;
	if SICCD ge 3824 and SICCD le 3824 then FF17IND = 11;
	if SICCD ge 3825 and SICCD le 3825 then FF17IND = 11;
	if SICCD ge 3826 and SICCD le 3826 then FF17IND = 11;
	if SICCD ge 3827 and SICCD le 3827 then FF17IND = 11;
	if SICCD ge 3829 and SICCD le 3829 then FF17IND = 11;
	if SICCD ge 3830 and SICCD le 3839 then FF17IND = 11;
	if SICCD ge 3950 and SICCD le 3955 then FF17IND = 11;
	if SICCD ge 5060 and SICCD le 5060 then FF17IND = 11;
	if SICCD ge 5063 and SICCD le 5063 then FF17IND = 11;
	if SICCD ge 5065 and SICCD le 5065 then FF17IND = 11;
	if SICCD ge 5080 and SICCD le 5080 then FF17IND = 11;
	if SICCD ge 5081 and SICCD le 5081 then FF17IND = 11;
	if SICCD ge 3710 and SICCD le 3710 then FF17IND = 12;
	if SICCD ge 3711 and SICCD le 3711 then FF17IND = 12;
	if SICCD ge 3714 and SICCD le 3714 then FF17IND = 12;
	if SICCD ge 3716 and SICCD le 3716 then FF17IND = 12;
	if SICCD ge 3750 and SICCD le 3751 then FF17IND = 12;
	if SICCD ge 3792 and SICCD le 3792 then FF17IND = 12;
	if SICCD ge 5010 and SICCD le 5015 then FF17IND = 12;
	if SICCD ge 5510 and SICCD le 5521 then FF17IND = 12;
	if SICCD ge 5530 and SICCD le 5531 then FF17IND = 12;
	if SICCD ge 5560 and SICCD le 5561 then FF17IND = 12;
	if SICCD ge 5570 and SICCD le 5571 then FF17IND = 12;
	if SICCD ge 5590 and SICCD le 5599 then FF17IND = 12;
	if SICCD ge 3713 and SICCD le 3713 then FF17IND = 13;
	if SICCD ge 3715 and SICCD le 3715 then FF17IND = 13;
	if SICCD ge 3720 and SICCD le 3720 then FF17IND = 13;
	if SICCD ge 3721 and SICCD le 3721 then FF17IND = 13;
	if SICCD ge 3724 and SICCD le 3724 then FF17IND = 13;
	if SICCD ge 3725 and SICCD le 3725 then FF17IND = 13;
	if SICCD ge 3728 and SICCD le 3728 then FF17IND = 13;
	if SICCD ge 3730 and SICCD le 3731 then FF17IND = 13;
	if SICCD ge 3732 and SICCD le 3732 then FF17IND = 13;
	if SICCD ge 3740 and SICCD le 3743 then FF17IND = 13;
	if SICCD ge 3760 and SICCD le 3769 then FF17IND = 13;
	if SICCD ge 3790 and SICCD le 3790 then FF17IND = 13;
	if SICCD ge 3795 and SICCD le 3795 then FF17IND = 13;
	if SICCD ge 3799 and SICCD le 3799 then FF17IND = 13;
	if SICCD ge 4000 and SICCD le 4013 then FF17IND = 13;
	if SICCD ge 4100 and SICCD le 4100 then FF17IND = 13;
	if SICCD ge 4110 and SICCD le 4119 then FF17IND = 13;
	if SICCD ge 4120 and SICCD le 4121 then FF17IND = 13;
	if SICCD ge 4130 and SICCD le 4131 then FF17IND = 13;
	if SICCD ge 4140 and SICCD le 4142 then FF17IND = 13;
	if SICCD ge 4150 and SICCD le 4151 then FF17IND = 13;
	if SICCD ge 4170 and SICCD le 4173 then FF17IND = 13;
	if SICCD ge 4190 and SICCD le 4199 then FF17IND = 13;
	if SICCD ge 4200 and SICCD le 4200 then FF17IND = 13;
	if SICCD ge 4210 and SICCD le 4219 then FF17IND = 13;
	if SICCD ge 4220 and SICCD le 4229 then FF17IND = 13;
	if SICCD ge 4230 and SICCD le 4231 then FF17IND = 13;
	if SICCD ge 4400 and SICCD le 4499 then FF17IND = 13;
	if SICCD ge 4500 and SICCD le 4599 then FF17IND = 13;
	if SICCD ge 4600 and SICCD le 4699 then FF17IND = 13;
	if SICCD ge 4700 and SICCD le 4700 then FF17IND = 13;
	if SICCD ge 4710 and SICCD le 4712 then FF17IND = 13;
	if SICCD ge 4720 and SICCD le 4729 then FF17IND = 13;
	if SICCD ge 4730 and SICCD le 4739 then FF17IND = 13;
	if SICCD ge 4740 and SICCD le 4742 then FF17IND = 13;
	if SICCD ge 4780 and SICCD le 4780 then FF17IND = 13;
	if SICCD ge 4783 and SICCD le 4783 then FF17IND = 13;
	if SICCD ge 4785 and SICCD le 4785 then FF17IND = 13;
	if SICCD ge 4789 and SICCD le 4789 then FF17IND = 13;
	if SICCD ge 4900 and SICCD le 4900 then FF17IND = 14;
	if SICCD ge 4910 and SICCD le 4911 then FF17IND = 14;
	if SICCD ge 4920 and SICCD le 4922 then FF17IND = 14;
	if SICCD ge 4923 and SICCD le 4923 then FF17IND = 14;
	if SICCD ge 4924 and SICCD le 4925 then FF17IND = 14;
	if SICCD ge 4930 and SICCD le 4931 then FF17IND = 14;
	if SICCD ge 4932 and SICCD le 4932 then FF17IND = 14;
	if SICCD ge 4939 and SICCD le 4939 then FF17IND = 14;
	if SICCD ge 4940 and SICCD le 4942 then FF17IND = 14;
	if SICCD ge 5260 and SICCD le 5261 then FF17IND = 15;
	if SICCD ge 5270 and SICCD le 5271 then FF17IND = 15;
	if SICCD ge 5300 and SICCD le 5300 then FF17IND = 15;
	if SICCD ge 5310 and SICCD le 5311 then FF17IND = 15;
	if SICCD ge 5320 and SICCD le 5320 then FF17IND = 15;
	if SICCD ge 5330 and SICCD le 5331 then FF17IND = 15;
	if SICCD ge 5334 and SICCD le 5334 then FF17IND = 15;
	if SICCD ge 5390 and SICCD le 5399 then FF17IND = 15;
	if SICCD ge 5400 and SICCD le 5400 then FF17IND = 15;
	if SICCD ge 5410 and SICCD le 5411 then FF17IND = 15;
	if SICCD ge 5412 and SICCD le 5412 then FF17IND = 15;
	if SICCD ge 5420 and SICCD le 5421 then FF17IND = 15;
	if SICCD ge 5430 and SICCD le 5431 then FF17IND = 15;
	if SICCD ge 5440 and SICCD le 5441 then FF17IND = 15;
	if SICCD ge 5450 and SICCD le 5451 then FF17IND = 15;
	if SICCD ge 5460 and SICCD le 5461 then FF17IND = 15;
	if SICCD ge 5490 and SICCD le 5499 then FF17IND = 15;
	if SICCD ge 5540 and SICCD le 5541 then FF17IND = 15;
	if SICCD ge 5550 and SICCD le 5551 then FF17IND = 15;
	if SICCD ge 5600 and SICCD le 5699 then FF17IND = 15;
	if SICCD ge 5700 and SICCD le 5700 then FF17IND = 15;
	if SICCD ge 5710 and SICCD le 5719 then FF17IND = 15;
	if SICCD ge 5720 and SICCD le 5722 then FF17IND = 15;
	if SICCD ge 5730 and SICCD le 5733 then FF17IND = 15;
	if SICCD ge 5734 and SICCD le 5734 then FF17IND = 15;
	if SICCD ge 5735 and SICCD le 5735 then FF17IND = 15;
	if SICCD ge 5736 and SICCD le 5736 then FF17IND = 15;
	if SICCD ge 5750 and SICCD le 5750 then FF17IND = 15;
	if SICCD ge 5800 and SICCD le 5813 then FF17IND = 15;
	if SICCD ge 5890 and SICCD le 5890 then FF17IND = 15;
	if SICCD ge 5900 and SICCD le 5900 then FF17IND = 15;
	if SICCD ge 5910 and SICCD le 5912 then FF17IND = 15;
	if SICCD ge 5920 and SICCD le 5921 then FF17IND = 15;
	if SICCD ge 5930 and SICCD le 5932 then FF17IND = 15;
	if SICCD ge 5940 and SICCD le 5940 then FF17IND = 15;
	if SICCD ge 5941 and SICCD le 5941 then FF17IND = 15;
	if SICCD ge 5942 and SICCD le 5942 then FF17IND = 15;
	if SICCD ge 5943 and SICCD le 5943 then FF17IND = 15;
	if SICCD ge 5944 and SICCD le 5944 then FF17IND = 15;
	if SICCD ge 5945 and SICCD le 5945 then FF17IND = 15;
	if SICCD ge 5946 and SICCD le 5946 then FF17IND = 15;
	if SICCD ge 5947 and SICCD le 5947 then FF17IND = 15;
	if SICCD ge 5948 and SICCD le 5948 then FF17IND = 15;
	if SICCD ge 5949 and SICCD le 5949 then FF17IND = 15;
	if SICCD ge 5960 and SICCD le 5963 then FF17IND = 15;
	if SICCD ge 5980 and SICCD le 5989 then FF17IND = 15;
	if SICCD ge 5990 and SICCD le 5990 then FF17IND = 15;
	if SICCD ge 5992 and SICCD le 5992 then FF17IND = 15;
	if SICCD ge 5993 and SICCD le 5993 then FF17IND = 15;
	if SICCD ge 5994 and SICCD le 5994 then FF17IND = 15;
	if SICCD ge 5995 and SICCD le 5995 then FF17IND = 15;
	if SICCD ge 5999 and SICCD le 5999 then FF17IND = 15;
	if SICCD ge 6010 and SICCD le 6019 then FF17IND = 16;
	if SICCD ge 6020 and SICCD le 6020 then FF17IND = 16;
	if SICCD ge 6021 and SICCD le 6021 then FF17IND = 16;
	if SICCD ge 6022 and SICCD le 6022 then FF17IND = 16;
	if SICCD ge 6023 and SICCD le 6023 then FF17IND = 16;
	if SICCD ge 6025 and SICCD le 6025 then FF17IND = 16;
	if SICCD ge 6026 and SICCD le 6026 then FF17IND = 16;
	if SICCD ge 6028 and SICCD le 6029 then FF17IND = 16;
	if SICCD ge 6030 and SICCD le 6036 then FF17IND = 16;
	if SICCD ge 6040 and SICCD le 6049 then FF17IND = 16;
	if SICCD ge 6050 and SICCD le 6059 then FF17IND = 16;
	if SICCD ge 6060 and SICCD le 6062 then FF17IND = 16;
	if SICCD ge 6080 and SICCD le 6082 then FF17IND = 16;
	if SICCD ge 6090 and SICCD le 6099 then FF17IND = 16;
	if SICCD ge 6100 and SICCD le 6100 then FF17IND = 16;
	if SICCD ge 6110 and SICCD le 6111 then FF17IND = 16;
	if SICCD ge 6112 and SICCD le 6112 then FF17IND = 16;
	if SICCD ge 6120 and SICCD le 6129 then FF17IND = 16;
	if SICCD ge 6140 and SICCD le 6149 then FF17IND = 16;
	if SICCD ge 6150 and SICCD le 6159 then FF17IND = 16;
	if SICCD ge 6160 and SICCD le 6163 then FF17IND = 16;
	if SICCD ge 6172 and SICCD le 6172 then FF17IND = 16;
	if SICCD ge 6199 and SICCD le 6199 then FF17IND = 16;
	if SICCD ge 6200 and SICCD le 6299 then FF17IND = 16;
	if SICCD ge 6300 and SICCD le 6300 then FF17IND = 16;
	if SICCD ge 6310 and SICCD le 6312 then FF17IND = 16;
	if SICCD ge 6320 and SICCD le 6324 then FF17IND = 16;
	if SICCD ge 6330 and SICCD le 6331 then FF17IND = 16;
	if SICCD ge 6350 and SICCD le 6351 then FF17IND = 16;
	if SICCD ge 6360 and SICCD le 6361 then FF17IND = 16;
	if SICCD ge 6370 and SICCD le 6371 then FF17IND = 16;
	if SICCD ge 6390 and SICCD le 6399 then FF17IND = 16;
	if SICCD ge 6400 and SICCD le 6411 then FF17IND = 16;
	if SICCD ge 6500 and SICCD le 6500 then FF17IND = 16;
	if SICCD ge 6510 and SICCD le 6510 then FF17IND = 16;
	if SICCD ge 6512 and SICCD le 6512 then FF17IND = 16;
	if SICCD ge 6513 and SICCD le 6513 then FF17IND = 16;
	if SICCD ge 6514 and SICCD le 6514 then FF17IND = 16;
	if SICCD ge 6515 and SICCD le 6515 then FF17IND = 16;
	if SICCD ge 6517 and SICCD le 6519 then FF17IND = 16;
	if SICCD ge 6530 and SICCD le 6531 then FF17IND = 16;
	if SICCD ge 6532 and SICCD le 6532 then FF17IND = 16;
	if SICCD ge 6540 and SICCD le 6541 then FF17IND = 16;
	if SICCD ge 6550 and SICCD le 6553 then FF17IND = 16;
	if SICCD ge 6611 and SICCD le 6611 then FF17IND = 16;
	if SICCD ge 6700 and SICCD le 6700 then FF17IND = 16;
	if SICCD ge 6710 and SICCD le 6719 then FF17IND = 16;
	if SICCD ge 6720 and SICCD le 6722 then FF17IND = 16;
	if SICCD ge 6723 and SICCD le 6723 then FF17IND = 16;
	if SICCD ge 6724 and SICCD le 6724 then FF17IND = 16;
	if SICCD ge 6725 and SICCD le 6725 then FF17IND = 16;
	if SICCD ge 6726 and SICCD le 6726 then FF17IND = 16;
	if SICCD ge 6730 and SICCD le 6733 then FF17IND = 16;
	if SICCD ge 6790 and SICCD le 6790 then FF17IND = 16;
	if SICCD ge 6792 and SICCD le 6792 then FF17IND = 16;
	if SICCD ge 6794 and SICCD le 6794 then FF17IND = 16;
	if SICCD ge 6795 and SICCD le 6795 then FF17IND = 16;
	if SICCD ge 6798 and SICCD le 6798 then FF17IND = 16;
	if SICCD ge 6799 and SICCD le 6799 then FF17IND = 16;
	if SICCD ge 2520 and SICCD le 2549 then FF17IND = 17;
	if SICCD ge 2600 and SICCD le 2639 then FF17IND = 17;
	if SICCD ge 2640 and SICCD le 2659 then FF17IND = 17;
	if SICCD ge 2661 and SICCD le 2661 then FF17IND = 17;
	if SICCD ge 2670 and SICCD le 2699 then FF17IND = 17;
	if SICCD ge 2700 and SICCD le 2709 then FF17IND = 17;
	if SICCD ge 2710 and SICCD le 2719 then FF17IND = 17;
	if SICCD ge 2720 and SICCD le 2729 then FF17IND = 17;
	if SICCD ge 2730 and SICCD le 2739 then FF17IND = 17;
	if SICCD ge 2740 and SICCD le 2749 then FF17IND = 17;
	if SICCD ge 2750 and SICCD le 2759 then FF17IND = 17;
	if SICCD ge 2760 and SICCD le 2761 then FF17IND = 17;
	if SICCD ge 2770 and SICCD le 2771 then FF17IND = 17;
	if SICCD ge 2780 and SICCD le 2789 then FF17IND = 17;
	if SICCD ge 2790 and SICCD le 2799 then FF17IND = 17;
	if SICCD ge 2835 and SICCD le 2835 then FF17IND = 17;
	if SICCD ge 2836 and SICCD le 2836 then FF17IND = 17;
	if SICCD ge 2990 and SICCD le 2999 then FF17IND = 17;
	if SICCD ge 3000 and SICCD le 3000 then FF17IND = 17;
	if SICCD ge 3010 and SICCD le 3011 then FF17IND = 17;
	if SICCD ge 3041 and SICCD le 3041 then FF17IND = 17;
	if SICCD ge 3050 and SICCD le 3053 then FF17IND = 17;
	if SICCD ge 3160 and SICCD le 3161 then FF17IND = 17;
	if SICCD ge 3170 and SICCD le 3171 then FF17IND = 17;
	if SICCD ge 3172 and SICCD le 3172 then FF17IND = 17;
	if SICCD ge 3190 and SICCD le 3199 then FF17IND = 17;
	if SICCD ge 3220 and SICCD le 3221 then FF17IND = 17;
	if SICCD ge 3229 and SICCD le 3229 then FF17IND = 17;
	if SICCD ge 3230 and SICCD le 3231 then FF17IND = 17;
	if SICCD ge 3260 and SICCD le 3260 then FF17IND = 17;
	if SICCD ge 3262 and SICCD le 3263 then FF17IND = 17;
	if SICCD ge 3269 and SICCD le 3269 then FF17IND = 17;
	if SICCD ge 3295 and SICCD le 3299 then FF17IND = 17;
	if SICCD ge 3537 and SICCD le 3537 then FF17IND = 17;
	if SICCD ge 3640 and SICCD le 3644 then FF17IND = 17;
	if SICCD ge 3645 and SICCD le 3645 then FF17IND = 17;
	if SICCD ge 3646 and SICCD le 3646 then FF17IND = 17;
	if SICCD ge 3647 and SICCD le 3647 then FF17IND = 17;
	if SICCD ge 3648 and SICCD le 3649 then FF17IND = 17;
	if SICCD ge 3660 and SICCD le 3660 then FF17IND = 17;
	if SICCD ge 3661 and SICCD le 3661 then FF17IND = 17;
	if SICCD ge 3662 and SICCD le 3662 then FF17IND = 17;
	if SICCD ge 3663 and SICCD le 3663 then FF17IND = 17;
	if SICCD ge 3664 and SICCD le 3664 then FF17IND = 17;
	if SICCD ge 3665 and SICCD le 3665 then FF17IND = 17;
	if SICCD ge 3666 and SICCD le 3666 then FF17IND = 17;
	if SICCD ge 3669 and SICCD le 3669 then FF17IND = 17;
	if SICCD ge 3840 and SICCD le 3849 then FF17IND = 17;
	if SICCD ge 3850 and SICCD le 3851 then FF17IND = 17;
	if SICCD ge 3991 and SICCD le 3991 then FF17IND = 17;
	if SICCD ge 3993 and SICCD le 3993 then FF17IND = 17;
	if SICCD ge 3995 and SICCD le 3995 then FF17IND = 17;
	if SICCD ge 3996 and SICCD le 3996 then FF17IND = 17;
	if SICCD ge 4810 and SICCD le 4813 then FF17IND = 17;
	if SICCD ge 4820 and SICCD le 4822 then FF17IND = 17;
	if SICCD ge 4830 and SICCD le 4839 then FF17IND = 17;
	if SICCD ge 4840 and SICCD le 4841 then FF17IND = 17;
	if SICCD ge 4890 and SICCD le 4890 then FF17IND = 17;
	if SICCD ge 4891 and SICCD le 4891 then FF17IND = 17;
	if SICCD ge 4892 and SICCD le 4892 then FF17IND = 17;
	if SICCD ge 4899 and SICCD le 4899 then FF17IND = 17;
	if SICCD ge 4950 and SICCD le 4959 then FF17IND = 17;
	if SICCD ge 4960 and SICCD le 4961 then FF17IND = 17;
	if SICCD ge 4970 and SICCD le 4971 then FF17IND = 17;
	if SICCD ge 4991 and SICCD le 4991 then FF17IND = 17;
	if SICCD ge 5040 and SICCD le 5042 then FF17IND = 17;
	if SICCD ge 5043 and SICCD le 5043 then FF17IND = 17;
	if SICCD ge 5044 and SICCD le 5044 then FF17IND = 17;
	if SICCD ge 5045 and SICCD le 5045 then FF17IND = 17;
	if SICCD ge 5046 and SICCD le 5046 then FF17IND = 17;
	if SICCD ge 5047 and SICCD le 5047 then FF17IND = 17;
	if SICCD ge 5048 and SICCD le 5048 then FF17IND = 17;
	if SICCD ge 5049 and SICCD le 5049 then FF17IND = 17;
	if SICCD ge 5082 and SICCD le 5082 then FF17IND = 17;
	if SICCD ge 5083 and SICCD le 5083 then FF17IND = 17;
	if SICCD ge 5084 and SICCD le 5084 then FF17IND = 17;
	if SICCD ge 5085 and SICCD le 5085 then FF17IND = 17;
	if SICCD ge 5086 and SICCD le 5087 then FF17IND = 17;
	if SICCD ge 5088 and SICCD le 5088 then FF17IND = 17;
	if SICCD ge 5090 and SICCD le 5090 then FF17IND = 17;
	if SICCD ge 5091 and SICCD le 5092 then FF17IND = 17;
	if SICCD ge 5093 and SICCD le 5093 then FF17IND = 17;
	if SICCD ge 5100 and SICCD le 5100 then FF17IND = 17;
	if SICCD ge 5110 and SICCD le 5113 then FF17IND = 17;
	if SICCD ge 5199 and SICCD le 5199 then FF17IND = 17;
	if SICCD ge 7000 and SICCD le 7000 then FF17IND = 17;
	if SICCD ge 7010 and SICCD le 7011 then FF17IND = 17;
	if SICCD ge 7020 and SICCD le 7021 then FF17IND = 17;
	if SICCD ge 7030 and SICCD le 7033 then FF17IND = 17;
	if SICCD ge 7040 and SICCD le 7041 then FF17IND = 17;
	if SICCD ge 7200 and SICCD le 7200 then FF17IND = 17;
	if SICCD ge 7210 and SICCD le 7212 then FF17IND = 17;
	if SICCD ge 7213 and SICCD le 7213 then FF17IND = 17;
	if SICCD ge 7215 and SICCD le 7216 then FF17IND = 17;
	if SICCD ge 7217 and SICCD le 7217 then FF17IND = 17;
	if SICCD ge 7218 and SICCD le 7218 then FF17IND = 17;
	if SICCD ge 7219 and SICCD le 7219 then FF17IND = 17;
	if SICCD ge 7220 and SICCD le 7221 then FF17IND = 17;
	if SICCD ge 7230 and SICCD le 7231 then FF17IND = 17;
	if SICCD ge 7240 and SICCD le 7241 then FF17IND = 17;
	if SICCD ge 7250 and SICCD le 7251 then FF17IND = 17;
	if SICCD ge 7260 and SICCD le 7269 then FF17IND = 17;
	if SICCD ge 7290 and SICCD le 7290 then FF17IND = 17;
	if SICCD ge 7291 and SICCD le 7291 then FF17IND = 17;
	if SICCD ge 7299 and SICCD le 7299 then FF17IND = 17;
	if SICCD ge 7300 and SICCD le 7300 then FF17IND = 17;
	if SICCD ge 7310 and SICCD le 7319 then FF17IND = 17;
	if SICCD ge 7320 and SICCD le 7323 then FF17IND = 17;
	if SICCD ge 7330 and SICCD le 7338 then FF17IND = 17;
	if SICCD ge 7340 and SICCD le 7342 then FF17IND = 17;
	if SICCD ge 7349 and SICCD le 7349 then FF17IND = 17;
	if SICCD ge 7350 and SICCD le 7351 then FF17IND = 17;
	if SICCD ge 7352 and SICCD le 7352 then FF17IND = 17;
	if SICCD ge 7353 and SICCD le 7353 then FF17IND = 17;
	if SICCD ge 7359 and SICCD le 7359 then FF17IND = 17;
	if SICCD ge 7360 and SICCD le 7369 then FF17IND = 17;
	if SICCD ge 7370 and SICCD le 7372 then FF17IND = 17;
	if SICCD ge 7373 and SICCD le 7373 then FF17IND = 17;
	if SICCD ge 7374 and SICCD le 7374 then FF17IND = 17;
	if SICCD ge 7375 and SICCD le 7375 then FF17IND = 17;
	if SICCD ge 7376 and SICCD le 7376 then FF17IND = 17;
	if SICCD ge 7377 and SICCD le 7377 then FF17IND = 17;
	if SICCD ge 7378 and SICCD le 7378 then FF17IND = 17;
	if SICCD ge 7379 and SICCD le 7379 then FF17IND = 17;
	if SICCD ge 7380 and SICCD le 7380 then FF17IND = 17;
	if SICCD ge 7381 and SICCD le 7382 then FF17IND = 17;
	if SICCD ge 7383 and SICCD le 7383 then FF17IND = 17;
	if SICCD ge 7384 and SICCD le 7384 then FF17IND = 17;
	if SICCD ge 7385 and SICCD le 7385 then FF17IND = 17;
	if SICCD ge 7389 and SICCD le 7390 then FF17IND = 17;
	if SICCD ge 7391 and SICCD le 7391 then FF17IND = 17;
	if SICCD ge 7392 and SICCD le 7392 then FF17IND = 17;
	if SICCD ge 7393 and SICCD le 7393 then FF17IND = 17;
	if SICCD ge 7394 and SICCD le 7394 then FF17IND = 17;
	if SICCD ge 7395 and SICCD le 7395 then FF17IND = 17;
	if SICCD ge 7397 and SICCD le 7397 then FF17IND = 17;
	if SICCD ge 7399 and SICCD le 7399 then FF17IND = 17;
	if SICCD ge 7500 and SICCD le 7500 then FF17IND = 17;
	if SICCD ge 7510 and SICCD le 7519 then FF17IND = 17;
	if SICCD ge 7520 and SICCD le 7523 then FF17IND = 17;
	if SICCD ge 7530 and SICCD le 7539 then FF17IND = 17;
	if SICCD ge 7540 and SICCD le 7549 then FF17IND = 17;
	if SICCD ge 7600 and SICCD le 7600 then FF17IND = 17;
	if SICCD ge 7620 and SICCD le 7620 then FF17IND = 17;
	if SICCD ge 7622 and SICCD le 7622 then FF17IND = 17;
	if SICCD ge 7623 and SICCD le 7623 then FF17IND = 17;
	if SICCD ge 7629 and SICCD le 7629 then FF17IND = 17;
	if SICCD ge 7630 and SICCD le 7631 then FF17IND = 17;
	if SICCD ge 7640 and SICCD le 7641 then FF17IND = 17;
	if SICCD ge 7690 and SICCD le 7699 then FF17IND = 17;
	if SICCD ge 7800 and SICCD le 7829 then FF17IND = 17;
	if SICCD ge 7830 and SICCD le 7833 then FF17IND = 17;
	if SICCD ge 7840 and SICCD le 7841 then FF17IND = 17;
	if SICCD ge 7900 and SICCD le 7900 then FF17IND = 17;
	if SICCD ge 7910 and SICCD le 7911 then FF17IND = 17;
	if SICCD ge 7920 and SICCD le 7929 then FF17IND = 17;
	if SICCD ge 7930 and SICCD le 7933 then FF17IND = 17;
	if SICCD ge 7940 and SICCD le 7949 then FF17IND = 17;
	if SICCD ge 7980 and SICCD le 7980 then FF17IND = 17;
	if SICCD ge 7990 and SICCD le 7999 then FF17IND = 17;
	if SICCD ge 8000 and SICCD le 8099 then FF17IND = 17;
	if SICCD ge 8100 and SICCD le 8199 then FF17IND = 17;
	if SICCD ge 8200 and SICCD le 8299 then FF17IND = 17;
	if SICCD ge 8300 and SICCD le 8399 then FF17IND = 17;
	if SICCD ge 8400 and SICCD le 8499 then FF17IND = 17;
	if SICCD ge 8600 and SICCD le 8699 then FF17IND = 17;
	if SICCD ge 8700 and SICCD le 8700 then FF17IND = 17;
	if SICCD ge 8710 and SICCD le 8713 then FF17IND = 17;
	if SICCD ge 8720 and SICCD le 8721 then FF17IND = 17;
	if SICCD ge 8730 and SICCD le 8734 then FF17IND = 17;
	if SICCD ge 8740 and SICCD le 8748 then FF17IND = 17;
	if SICCD ge 8800 and SICCD le 8899 then FF17IND = 17;
	if SICCD ge 8900 and SICCD le 8910 then FF17IND = 17;
	if SICCD ge 8911 and SICCD le 8911 then FF17IND = 17;
	if SICCD ge 8920 and SICCD le 8999 then FF17IND = 17;
	if FF17IND ne .;
	label FF17IND = "Fama French 17 Industry Code";
	label NMLRET = "Number of Monthly Returns";
	label TMLRET = "Total Monthly Returns";
run;

proc sort data = crspfinal;
by FF17IND YEAR;
quit;

proc means data = crspfinal n mean std noprint;
by FF17IND YEAR;
var TLRET;
output out = crspstatistics n = NFIRMS mean = MEANRET std = STDRET;
quit;

data crspstatistics;
set crspstatistics;
drop _TYPE_ _FREQ_;
label NFIRMS = "Number of Firm Year Observations";
label MEANRET = "Mean of Yearly Adjusted FF17IND Returns";
label STDRET = "Standard Deviation of Yearly Adjusted FF17IND Returns";
run;

proc download data = crspstatistics out = harford.crspstatistics;
quit;
